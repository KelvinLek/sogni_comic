"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const lodash_1 = require("lodash");
const TypedEventEmitter_1 = __importDefault(require("./TypedEventEmitter"));
class DataEntity extends TypedEventEmitter_1.default {
    constructor(data) {
        super();
        this.lastUpdated = new Date();
        this.data = data;
    }
    /**
     * @internal
     * @param delta
     */
    _update(delta) {
        //@ts-ignore
        const changedKeys = Object.keys(delta).filter((key) => this.data[key] !== delta[key]);
        this.data = Object.assign(Object.assign({}, this.data), delta);
        this.lastUpdated = new Date();
        this.emit('updated', changedKeys);
    }
    /**
     * Get a copy of the entity's data
     */
    toJSON() {
        return (0, lodash_1.cloneDeep)(this.data);
    }
}
exports.default = DataEntity;
//# sourceMappingURL=DataEntity.js.map